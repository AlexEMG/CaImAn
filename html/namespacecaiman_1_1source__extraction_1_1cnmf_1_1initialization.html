<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Caiman: caiman.source_extraction.cnmf.initialization Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Caiman_logo_FIsmall.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Caiman
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A Computational toolbox for large scale Calcium Imaging Analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">caiman.source_extraction.cnmf.initialization Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad762ff1c4aefedc408fe609de7cb1ebc"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization.html#ad762ff1c4aefedc408fe609de7cb1ebc">initialize_components</a> (Y, K=30, gSig=[5, gSiz=None, ssub=1, tsub=1, nIter=5, maxIter=5, nb=1, kernel=None, use_hals=True, normalize_init=True, img=None, method='greedy_roi', max_iter_snmf=500, alpha_snmf=10e2, sigma_smooth_snmf=(.5,.5,.5), perc_baseline_snmf=20, options_local_NMF=None)</td></tr>
<tr class="memdesc:ad762ff1c4aefedc408fe609de7cb1ebc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initalize components.  <a href="#ad762ff1c4aefedc408fe609de7cb1ebc">More...</a><br /></td></tr>
<tr class="separator:ad762ff1c4aefedc408fe609de7cb1ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88bfdfe3cc85c90317fb6d8d6c09f792"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization.html#a88bfdfe3cc85c90317fb6d8d6c09f792">ICA_PCA</a> (Y_ds, nr, sigma_smooth=(.5,.5,.5), truncate=2, fun='logcosh', max_iter=1000, tol=1e-10, remove_baseline=True, perc_baseline=20, nb=1)</td></tr>
<tr class="memdesc:a88bfdfe3cc85c90317fb6d8d6c09f792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization using ICA and PCA.  <a href="#a88bfdfe3cc85c90317fb6d8d6c09f792">More...</a><br /></td></tr>
<tr class="separator:a88bfdfe3cc85c90317fb6d8d6c09f792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12935eff3707e6c9e0e56b2152a90bd5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization.html#a12935eff3707e6c9e0e56b2152a90bd5">sparseNMF</a> (Y_ds, nr, max_iter_snmf=500, alpha=10e2, sigma_smooth=(.5,.5,.5), remove_baseline=True, perc_baseline=20, nb=1, truncate=2)</td></tr>
<tr class="memdesc:a12935eff3707e6c9e0e56b2152a90bd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initilaization using sparse NMF.  <a href="#a12935eff3707e6c9e0e56b2152a90bd5">More...</a><br /></td></tr>
<tr class="separator:a12935eff3707e6c9e0e56b2152a90bd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dd7bbb01fcb5237fc7d7674b870c9ae"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization.html#a7dd7bbb01fcb5237fc7d7674b870c9ae">greedyROI</a> (Y, nr=30, gSig=[5, gSiz=[11, nIter=5, kernel=None, nb=1)</td></tr>
<tr class="memdesc:a7dd7bbb01fcb5237fc7d7674b870c9ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Greedy initialization of spatial and temporal components using spatial Gaussian filtering.  <a href="#a7dd7bbb01fcb5237fc7d7674b870c9ae">More...</a><br /></td></tr>
<tr class="separator:a7dd7bbb01fcb5237fc7d7674b870c9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34abf87100936b47d488cefbb9def7e9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization.html#a34abf87100936b47d488cefbb9def7e9">finetune</a> (Y, cin, nIter=5)</td></tr>
<tr class="memdesc:a34abf87100936b47d488cefbb9def7e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute a initialized version of A and C  <a href="#a34abf87100936b47d488cefbb9def7e9">More...</a><br /></td></tr>
<tr class="separator:a34abf87100936b47d488cefbb9def7e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f4ada67920c28ee00d92af03cb4f8b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization.html#ac8f4ada67920c28ee00d92af03cb4f8b">imblur</a> (Y, sig=5, siz=11, nDimBlur=None, kernel=None, opencv=True)</td></tr>
<tr class="memdesc:ac8f4ada67920c28ee00d92af03cb4f8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spatial filtering with a Gaussian or user defined kernel.  <a href="#ac8f4ada67920c28ee00d92af03cb4f8b">More...</a><br /></td></tr>
<tr class="separator:ac8f4ada67920c28ee00d92af03cb4f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaedc4182f94a08193a9a93e9931bbb37"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization.html#aaedc4182f94a08193a9a93e9931bbb37">hals</a> (Y, A, C, b, f, bSiz=3, maxIter=5)</td></tr>
<tr class="memdesc:aaedc4182f94a08193a9a93e9931bbb37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hierarchical alternating least square method for solving NMF problem.  <a href="#aaedc4182f94a08193a9a93e9931bbb37">More...</a><br /></td></tr>
<tr class="separator:aaedc4182f94a08193a9a93e9931bbb37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a34abf87100936b47d488cefbb9def7e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34abf87100936b47d488cefbb9def7e9">&#9670;&nbsp;</a></span>finetune()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.initialization.finetune </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nIter</em> = <code>5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compute a initialized version of A and C </p>
<h2>Parameters </h2>
<p>Y D1*d2*T*K patches</p>
<p>c array T*K the inital calcium traces</p>
<p>nIter int True indicates that time is listed in the last axis of Y (matlab format) and moves it in the front</p>
<h2>Returns </h2>
<p>a array (d1,D2) the computed A as l2(Y*C)/Y*C</p>
<p>c array(T) C as the sum of As on x*y axis</p>
<hr/>
 
<p class="definition">Definition at line <a class="el" href="initialization_8py_source.html#l00501">501</a> of file <a class="el" href="initialization_8py_source.html">initialization.py</a>.</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization_a34abf87100936b47d488cefbb9def7e9_icgraph.svg" width="414" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7dd7bbb01fcb5237fc7d7674b870c9ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dd7bbb01fcb5237fc7d7674b870c9ae">&#9670;&nbsp;</a></span>greedyROI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.initialization.greedyROI </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nr</em> = <code>30</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gSig</em> = <code>[5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gSiz</em> = <code>[11</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nIter</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nb</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Greedy initialization of spatial and temporal components using spatial Gaussian filtering. </p>
<h2>Parameters </h2>
<p>Y np.array 3d or 4d array of fluorescence data with time appearing in the last axis.</p>
<p>nr int number of components to be found</p>
<p>gSig scalar or list of integers standard deviation of Gaussian kernel along each axis</p>
<p>gSiz scalar or list of integers size of spatial component</p>
<p>nIter int number of iterations when refining estimates</p>
<p>kernel np.ndarray User specified kernel to be used, if present, instead of Gaussian (default None)</p>
<p>nb int Number of background components</p>
<h2></h2>
<dl class="section return"><dt>Returns</dt><dd>A np.array 2d array of size (# of pixels) x nr with the spatial components. Each column is ordered columnwise (matlab format, order='F')</dd>
<dd>
C np.array 2d array of size nr X T with the temporal components</dd>
<dd>
center np.array 2d array of size nr x 2 [ or 3] with the components centroids</dd></dl>
<p>: Eftychios A. Pnevmatikakis based on a matlab implementation by Yuanjun Gao Simons Foundation, 2015</p>
<hr/>
<p> <a href="http://www.cell.com/neuron/pdf/S0896-6273(15)01084-3.pdf">http://www.cell.com/neuron/pdf/S0896-6273(15)01084-3.pdf</a> </p>

<p class="definition">Definition at line <a class="el" href="initialization_8py_source.html#l00413">413</a> of file <a class="el" href="initialization_8py_source.html">initialization.py</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization_a7dd7bbb01fcb5237fc7d7674b870c9ae_cgraph.svg" width="216" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization_a7dd7bbb01fcb5237fc7d7674b870c9ae_icgraph.svg" width="296" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aaedc4182f94a08193a9a93e9931bbb37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaedc4182f94a08193a9a93e9931bbb37">&#9670;&nbsp;</a></span>hals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.initialization.hals </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bSiz</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxIter</em> = <code>5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hierarchical alternating least square method for solving NMF problem. </p>
<p>Y = A*C + b*f</p>
<h2>input: </h2>
<p>Y d1 X d2 [X d3] X T, raw data. It will be reshaped to (d1*d2[*d3]) X T in this function</p>
<p>A (d1*d2[*d3]) X K, initial value of spatial components</p>
<p>C K X T, initial value of temporal components</p>
<p>b (d1*d2[*d3]) X nb, initial value of background spatial component</p>
<p>f nb X T, initial value of background temporal component</p>
<p>bSiz int or tuple of int blur size. A box kernel (bSiz X bSiz [X bSiz]) (if int) or bSiz (if tuple) will be convolved with each neuron's initial spatial component, then all nonzero pixels will be picked as pixels to be updated, and the rest will be forced to be 0.</p>
<p>maxIter maximum iteration of iterating HALS.</p>
<h2>output: </h2>
<p>the updated A, C, b, f</p>
<p>: Johannes Friedrich, Andrea Giovannucci</p>
<pre class="fragment">    http://proceedings.mlr.press/v39/kimura14.pdf</pre> 
<p class="definition">Definition at line <a class="el" href="initialization_8py_source.html#l00632">632</a> of file <a class="el" href="initialization_8py_source.html">initialization.py</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization_aaedc4182f94a08193a9a93e9931bbb37_icgraph.svg" width="256" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a88bfdfe3cc85c90317fb6d8d6c09f792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88bfdfe3cc85c90317fb6d8d6c09f792">&#9670;&nbsp;</a></span>ICA_PCA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.initialization.ICA_PCA </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y_ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sigma_smooth</em> = <code>(.5,&#160;.5,&#160;.5)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>truncate</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em> = <code>'logcosh'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>remove_baseline</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>perc_baseline</em> = <code>20</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nb</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialization using ICA and PCA. </p>
<p>DOES NOT WORK WELL WORK IN PROGRESS"</p>
<h2>Parameters </h2>
<h2></h2>

<p class="definition">Definition at line <a class="el" href="initialization_8py_source.html#l00237">237</a> of file <a class="el" href="initialization_8py_source.html">initialization.py</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization_a88bfdfe3cc85c90317fb6d8d6c09f792_icgraph.svg" width="288" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac8f4ada67920c28ee00d92af03cb4f8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8f4ada67920c28ee00d92af03cb4f8b">&#9670;&nbsp;</a></span>imblur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.initialization.imblur </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sig</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>siz</em> = <code>11</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nDimBlur</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>opencv</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Spatial filtering with a Gaussian or user defined kernel. </p>
<p>The parameters are specified in GreedyROI</p>
<p>:param Y: np.ndarray d1 x d2 [x d3] x T movie, raw data.</p>
<p>:param sig: [optional] list,tuple half size of neurons</p>
<p>:param siz: [optional] list,tuple size of kernel (default 2*tau + 1).</p>
<p>:param nDimBlur: [optional] if you want to specify the number of dimension</p>
<p>:param kernel: [optional] if you want to specify a kernel</p>
<p>:param opencv: [optional] if you want to process to the blur using open cv method</p>
<p>:return: the blurred image </p>

<p class="definition">Definition at line <a class="el" href="initialization_8py_source.html#l00548">548</a> of file <a class="el" href="initialization_8py_source.html">initialization.py</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization_ac8f4ada67920c28ee00d92af03cb4f8b_icgraph.svg" width="403" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad762ff1c4aefedc408fe609de7cb1ebc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad762ff1c4aefedc408fe609de7cb1ebc">&#9670;&nbsp;</a></span>initialize_components()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.initialization.initialize_components </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>K</em> = <code>30</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gSig</em> = <code>[5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gSiz</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ssub</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tsub</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nIter</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxIter</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nb</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kernel</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_hals</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normalize_init</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>img</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>'greedy_roi'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter_snmf</em> = <code>500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha_snmf</em> = <code>10e2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sigma_smooth_snmf</em> = <code>(.5,&#160;.5,&#160;.5)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>perc_baseline_snmf</em> = <code>20</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>options_local_NMF</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initalize components. </p>
<p>This method uses a greedy approach followed by hierarchical alternative least squares (HALS) NMF. Optional use of spatio-temporal downsampling to boost speed.</p>
<h2>Parameters </h2>
<p>Y np.ndarray d1 x d2 [x d3] x T movie, raw data.</p>
<p>K [optional] int number of neurons to extract (default value: 30).</p>
<p>tau [optional] list,tuple standard deviation of neuron size along x and y [and z] (default value: (5,5).</p>
<p>gSiz [optional] list,tuple size of kernel (default 2*tau + 1).</p>
<p>nIter [optional] int number of iterations for shape tuning (default 5).</p>
<p>maxIter [optional] int number of iterations for HALS algorithm (default 5).</p>
<p>ssub [optional] int spatial downsampling factor recommended for large datasets (default 1, no downsampling).</p>
<p>tsub [optional] int temporal downsampling factor recommended for long datasets (default 1, no downsampling).</p>
<p>kernel [optional] np.ndarray User specified kernel for greedyROI (default None, greedy ROI searches for Gaussian shaped neurons)</p>
<p>use_hals [optional] bool Whether to refine components with the hals method</p>
<p>normalize_init [optional] bool Whether to normalize_init data before running the initialization</p>
<p>img optional [np 2d array] Image with which to normalize. If not present use the mean + offset</p>
<p>method str Initialization method 'greedy_roi' or 'sparse_nmf'</p>
<p>max_iter_snmf int Maximum number of sparse NMF iterations</p>
<p>alpha_snmf scalar Sparsity penalty</p>
<h2></h2>
<dl class="section return"><dt>Returns</dt><dd>Ain np.ndarray (d1*d2[*d3]) x K , spatial filter of each neuron.</dd>
<dd>
Cin np.ndarray T x K , calcium activity of each neuron.</dd>
<dd>
center np.ndarray K x 2 [or 3] , inferred center of each neuron.</dd>
<dd>
bin np.ndarray (d1*d2[*d3]) x nb, initialization of spatial background.</dd>
<dd>
fin np.ndarray nb x T matrix, initalization of temporal background</dd></dl>
<h2>Raise </h2>
<p>Exception("Unsupported method")</p>
<p>Exception('You need to define arguments for local NMF') </p>

<p class="definition">Definition at line <a class="el" href="initialization_8py_source.html#l00113">113</a> of file <a class="el" href="initialization_8py_source.html">initialization.py</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization_ad762ff1c4aefedc408fe609de7cb1ebc_cgraph.svg" width="416" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a12935eff3707e6c9e0e56b2152a90bd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12935eff3707e6c9e0e56b2152a90bd5">&#9670;&nbsp;</a></span>sparseNMF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def caiman.source_extraction.cnmf.initialization.sparseNMF </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Y_ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter_snmf</em> = <code>500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>10e2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sigma_smooth</em> = <code>(.5,&#160;.5,&#160;.5)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>remove_baseline</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>perc_baseline</em> = <code>20</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nb</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>truncate</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initilaization using sparse NMF. </p>
<h2>Parameters </h2>
<p>max_iter_snm int number of iterations</p>
<p>alpha_snmf: sparsity regularizer</p>
<p>sigma_smooth_snmf: smoothing along z,x, and y (.5,.5,.5)</p>
<p>perc_baseline_snmf: percentile to remove frmo movie before NMF</p>
<p>nb int Number of background components</p>
<h2></h2>
<dl class="section return"><dt>Returns</dt><dd>A np.array 2d array of size (# of pixels) x nr with the spatial components. Each column is ordered columnwise (matlab format, order='F')</dd>
<dd>
C np.array 2d array of size nr X T with the temporal components</dd>
<dd>
center np.array 2d array of size nr x 2 [ or 3] with the components centroids </dd></dl>

<p class="definition">Definition at line <a class="el" href="initialization_8py_source.html#l00322">322</a> of file <a class="el" href="initialization_8py_source.html">initialization.py</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacecaiman_1_1source__extraction_1_1cnmf_1_1initialization_a12935eff3707e6c9e0e56b2152a90bd5_icgraph.svg" width="299" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="footer" role="contentinfo">
&copy; Copyright 2015, Eftychios Pnevmatikakis and Andrea Giovannucci.Created using 
<a href="http://www.stack.nl/~dimitri/doxygen/">Doxygen</a><
/div>